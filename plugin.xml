<?xml version="1.0" encoding="UTF-8"?>
<plugin xmlns="http://apache.org/cordova/ns/plugins/1.0" xmlns:android="http://schemas.android.com/apk/res/android" id="cordova-khenshin" version="0.0.1">
    <name>khenshin</name>
    <description>khenshin Cordova Plugin</description>
    <license>MIT</license>
    <author>khipu</author>

    <asset src="www/khenshin.js" target="js/khenshin.js"/>

    <js-module src="www/khenshin.js" name="khenshin">
        <clobbers target="khenshin"/>
    </js-module>

    <platform name="android">
        <preference name="TASK_API_URL" />
        <preference name="DUMP_API_URL" />
        <preference name="ANDROID_MAIN_BUTTON_STYLE" />
        <preference name="ALLOW_CREDENTIALS_SAVING" />
        <preference name="HIDE_WEB_ADDRESS" />
        <preference name="AUTOMATON_TIMEOUT" />
        <preference name="SKIP_EXIT_PAGE" />


        <framework src="src/android/khenshin.gradle" custom="true" type="gradleReference"/>

        <source-file src="src/android/com/browser2app/CordovaKhenshinApplication.java" target-dir="src/com/browser2app"/>

        <source-file src="src/android/com/browser2app/KhenshinPlugin.java" target-dir="src/com/browser2app"/>
        <config-file target="res/xml/config.xml" parent="/*">
            <feature name="Khenshin">
                <param name="android-package" value="com.browser2app.KhenshinPlugin"/>
            </feature>
        </config-file>

        <config-file target="AndroidManifest.xml" parent="/manifest/application">
            <meta-data
              android:name="com.browser2app.TASK_API_URL"
              android:value="$TASK_API_URL" />
            <meta-data
              android:name="com.browser2app.DUMP_API_URL"
              android:value="$DUMP_API_URL" />
            <meta-data
              android:name="com.browser2app.MAIN_BUTTON_STYLE"
              android:value="$ANDROID_MAIN_BUTTON_STYLE" />
            <meta-data
              android:name="com.browser2app.ALLOW_CREDENTIALS_SAVING"
              android:value="$ALLOW_CREDENTIALS_SAVING" />
            <meta-data
              android:name="com.browser2app.HIDE_WEB_ADDRESS"
              android:value="$HIDE_WEB_ADDRESS" />
            <meta-data
              android:name="com.browser2app.AUTOMATON_TIMEOUT"
              android:value="$AUTOMATON_TIMEOUT" />
            <meta-data
              android:name="com.browser2app.SKIP_EXIT_PAGE"
              android:value="$SKIP_EXIT_PAGE" />   
        </config-file>


        <hook type="before_plugin_install" src="scripts/android/beforeInstall.js"/>
    </platform>

    <platform name="ios">

        <dependency id="cordova-plugin-cocoapod-support"/>
        <pods-config ios-min-version="9.0" use-frameworks="true"/>

        <pod name="khenshin" git="git@bitbucket.org:khipu/khenshin-pod.git" tag="1.183"/>

        <hook type="before_compile" src="scripts/ios/fixEntitlementsBuildSetting.js"/>
        <source-file src="src/ios/PaymentProcessHeader.h" target-dir="src"/>
        <source-file src="src/ios/PaymentProcessHeader.m" target-dir="src"/>
        <source-file src="src/ios/PaymentProcessHeader.xib" target-dir="src"/>
        <source-file src="src/ios/KhenshinPlugin.h" target-dir="src"/>
        <source-file src="src/ios/KhenshinPlugin.m" target-dir="src"/>
        <config-file target="config.xml" parent="/*">
            <feature name="Khenshin">
                <param name="ios-package" value="KhenshinPlugin"/>
                <param name="onload" value="true"/>
            </feature>
        </config-file>
    </platform>

</plugin>